<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.edugame.server.controller.QuestionManagerController"
            prefHeight="800.0" prefWidth="1400.0"
            style="-fx-background-color: #1a1a1a;">

    <!-- Top: Header + Statistics -->
    <top>
        <VBox spacing="20" styleClass="main-container">
            <padding><Insets top="20" right="20" bottom="10" left="20"/></padding>

            <!-- Header -->
            <HBox alignment="CENTER_LEFT" spacing="15" styleClass="header">
                <Button text="â† Quay láº¡i" onAction="#handleBackToServer" styleClass="back-button"/>
                <Label text="Quáº£n lÃ½ CÃ¢u há»i" styleClass="header-title">
                    <font><Font name="System Bold" size="22"/></font>
                </Label>
            </HBox>

            <!-- Statistics Cards -->
            <HBox spacing="15" styleClass="stats-container">
                <VBox styleClass="stat-card stat-card-total" HBox.hgrow="ALWAYS">
                    <Label fx:id="totalQuestionsLabel" text="0" styleClass="stat-number"/>
                    <Label text="Tá»•ng cÃ¢u há»i" styleClass="stat-label"/>
                </VBox>

                <VBox styleClass="stat-card stat-card-math" HBox.hgrow="ALWAYS">
                    <Label fx:id="mathQuestionsLabel" text="0" styleClass="stat-number"/>
                    <Label text="ToÃ¡n há»c" styleClass="stat-label"/>
                </VBox>

                <VBox styleClass="stat-card stat-card-literature" HBox.hgrow="ALWAYS">
                    <Label fx:id="literatureQuestionsLabel" text="0" styleClass="stat-number"/>
                    <Label text="Ngá»¯ vÄƒn" styleClass="stat-label"/>
                </VBox>

                <VBox styleClass="stat-card stat-card-english" HBox.hgrow="ALWAYS">
                    <Label fx:id="englishQuestionsLabel" text="0" styleClass="stat-number"/>
                    <Label text="Tiáº¿ng Anh" styleClass="stat-label"/>
                </VBox>
            </HBox>

            <!-- Search and Filters -->
            <HBox spacing="15" alignment="CENTER_LEFT" styleClass="filter-container">
                <TextField fx:id="searchField" promptText="ðŸ” TÃ¬m kiáº¿m cÃ¢u há»i..."
                           styleClass="search-field" prefWidth="400"/>
                <Label text="MÃ´n há»c:" styleClass="filter-label"/>
                <ComboBox fx:id="subjectFilter" styleClass="filter-combo" prefWidth="150"/>
                <Label text="Äá»™ khÃ³:" styleClass="filter-label"/>
                <ComboBox fx:id="difficultyFilter" styleClass="filter-combo" prefWidth="150"/>
            </HBox>
        </VBox>
    </top>

    <!-- Center: Tab Pane -->
    <center>
        <TabPane styleClass="main-tab-pane" tabClosingPolicy="UNAVAILABLE">
            <padding><Insets top="0" right="20" bottom="20" left="20"/></padding>

            <!-- Tab 1: Quáº£n lÃ½ cÃ¢u há»i -->
            <Tab text="ðŸ“‹ Quáº£n lÃ½ cÃ¢u há»i" styleClass="main-tab">
                <SplitPane dividerPositions="0.6" styleClass="split-pane">

                    <!-- Left: Question Table -->
                    <VBox spacing="10" styleClass="table-container">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label text="Danh sÃ¡ch cÃ¢u há»i" styleClass="section-title">
                                <font><Font name="System Bold" size="16"/></font>
                            </Label>
                            <Label fx:id="selectedCountLabel" text="" styleClass="selected-label"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Button text="âŒ Bá» chá»n" onAction="#handleDeselectQuestion" styleClass="deselect-button"/>
                            <Button text="ðŸ—‘ï¸ XÃ³a" onAction="#handleDeleteQuestion" styleClass="delete-button"/>
                        </HBox>

                        <TableView fx:id="questionTable" VBox.vgrow="ALWAYS" styleClass="question-table">
                            <columns>
                                <TableColumn fx:id="sttColumn" text="STT" prefWidth="50"/>
                                <TableColumn fx:id="subjectColumn" text="MÃ´n há»c" prefWidth="100"/>
                                <TableColumn fx:id="contentColumn" text="Ná»™i dung" prefWidth="200"/>
                                <TableColumn fx:id="answerAColumn" text="A" prefWidth="90"/>
                                <TableColumn fx:id="answerBColumn" text="B" prefWidth="90"/>
                                <TableColumn fx:id="answerCColumn" text="C" prefWidth="90"/>
                                <TableColumn fx:id="answerDColumn" text="D" prefWidth="90"/>
                                <TableColumn fx:id="correctAnswerColumn" text="ÄÃºng" prefWidth="60"/>
                                <TableColumn fx:id="difficultyColumn" text="Äá»™ khÃ³" prefWidth="80"/>
                            </columns>
                        </TableView>
                    </VBox>

                    <!-- Right: Question Form -->
                    <ScrollPane fitToWidth="true" styleClass="scroll-pane">
                        <VBox spacing="15" styleClass="form-container">
                            <padding><Insets top="10" right="15" bottom="15" left="15"/></padding>

                            <HBox alignment="CENTER_LEFT" spacing="10">
                                <Label text="ThÃ´ng tin cÃ¢u há»i" styleClass="section-title">
                                    <font><Font name="System Bold" size="16"/></font>
                                </Label>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Button text="âž• Má»›i" onAction="#handleNewQuestion" styleClass="new-button"/>
                            </HBox>

                            <Separator/>

                            <!-- Question Content -->
                            <VBox spacing="5">
                                <Label text="Ná»™i dung cÃ¢u há»i *" styleClass="form-label"/>
                                <TextArea fx:id="questionContentArea" promptText="Nháº­p ná»™i dung cÃ¢u há»i..."
                                          prefRowCount="3" wrapText="true" styleClass="text-area"/>
                            </VBox>

                            <!-- Subject and Difficulty -->
                            <HBox spacing="15">
                                <VBox spacing="5" HBox.hgrow="ALWAYS">
                                    <Label text="MÃ´n há»c *" styleClass="form-label"/>
                                    <ComboBox fx:id="subjectCombo" promptText="Chá»n mÃ´n há»c"
                                              styleClass="form-combo" maxWidth="Infinity"/>
                                </VBox>

                                <VBox spacing="5" HBox.hgrow="ALWAYS">
                                    <Label text="Äá»™ khÃ³ *" styleClass="form-label"/>
                                    <ComboBox fx:id="difficultyCombo" promptText="Chá»n Ä‘á»™ khÃ³"
                                              styleClass="form-combo" maxWidth="Infinity"/>
                                </VBox>
                            </HBox>

                            <Separator/>

                            <!-- Answers -->
                            <VBox spacing="10">
                                <Label text="CÃ¡c Ä‘Ã¡p Ã¡n" styleClass="form-label">
                                    <font><Font name="System Bold" size="13"/></font>
                                </Label>

                                <VBox spacing="5">
                                    <Label text="ÄÃ¡p Ã¡n A *" styleClass="form-label-small"/>
                                    <TextField fx:id="answerAField" promptText="Nháº­p Ä‘Ã¡p Ã¡n A" styleClass="text-field"/>
                                </VBox>

                                <VBox spacing="5">
                                    <Label text="ÄÃ¡p Ã¡n B *" styleClass="form-label-small"/>
                                    <TextField fx:id="answerBField" promptText="Nháº­p Ä‘Ã¡p Ã¡n B" styleClass="text-field"/>
                                </VBox>

                                <VBox spacing="5">
                                    <Label text="ÄÃ¡p Ã¡n C *" styleClass="form-label-small"/>
                                    <TextField fx:id="answerCField" promptText="Nháº­p Ä‘Ã¡p Ã¡n C" styleClass="text-field"/>
                                </VBox>

                                <VBox spacing="5">
                                    <Label text="ÄÃ¡p Ã¡n D *" styleClass="form-label-small"/>
                                    <TextField fx:id="answerDField" promptText="Nháº­p Ä‘Ã¡p Ã¡n D" styleClass="text-field"/>
                                </VBox>
                            </VBox>

                            <Separator/>

                            <!-- Correct Answer -->
                            <VBox spacing="5">
                                <Label text="ÄÃ¡p Ã¡n Ä‘Ãºng *" styleClass="form-label"/>
                                <ComboBox fx:id="correctAnswerCombo" promptText="Chá»n Ä‘Ã¡p Ã¡n Ä‘Ãºng"
                                          styleClass="form-combo" prefWidth="150"/>
                            </VBox>

                            <!-- Action Buttons -->
                            <HBox spacing="10" alignment="CENTER" styleClass="button-container">
                                <padding><Insets top="10"/></padding>
                                <Button fx:id="saveButton" text="ThÃªm cÃ¢u há»i" onAction="#handleSaveQuestion"
                                        styleClass="save-button" prefWidth="150"/>
                                <Button text="LÃ m má»›i" onAction="#handleClearForm"
                                        styleClass="clear-button" prefWidth="100"/>
                            </HBox>
                        </VBox>
                    </ScrollPane>

                </SplitPane>
            </Tab>

            <!-- Tab 2: Import tá»« file -->
            <Tab text="ðŸ“ Import tá»« file" styleClass="main-tab">
                <ScrollPane fitToWidth="true" pannable="true" styleClass="scroll-pane">
                    <content>
                        <VBox spacing="20" alignment="TOP_CENTER" styleClass="tab-content">
                            <padding><Insets top="40" right="40" bottom="40" left="40"/></padding>

                            <Label text="ðŸ“„ Import cÃ¢u há»i tá»« file Excel/Word" styleClass="section-title">
                                <font><Font name="System Bold" size="18"/></font>
                            </Label>

                            <VBox spacing="20" alignment="CENTER" styleClass="upload-area" maxWidth="600">
                                <VBox spacing="15" alignment="CENTER">
                                    <Label text="ðŸ“‚" styleClass="upload-icon"/>
                                    <Label text="KÃ©o tháº£ file vÃ o Ä‘Ã¢y hoáº·c click Ä‘á»ƒ chá»n file"
                                           styleClass="upload-text"/>
                                    <Label text="Há»— trá»£: Excel (.xlsx, .xls) vÃ  Word (.docx, .doc)"
                                           styleClass="upload-hint"/>
                                </VBox>

                                <Button text="â¬† Chá»n file Ä‘á»ƒ upload" onAction="#handleImportFile"
                                        styleClass="upload-button"/>
                            </VBox>

                            <VBox spacing="10" alignment="CENTER_LEFT" styleClass="info-box">
                                <Label text="ðŸ“ HÆ°á»›ng dáº«n Ä‘á»‹nh dáº¡ng file:" styleClass="info-title"/>
                                <Label text="â€¢ Cá»™t 1: MÃ´n há»c (ToÃ¡n há»c/Ngá»¯ vÄƒn/Tiáº¿ng Anh)" styleClass="info-text"/>
                                <Label text="â€¢ Cá»™t 2: Äá»™ khÃ³ (Dá»…/Trung bÃ¬nh/KhÃ³)" styleClass="info-text"/>
                                <Label text="â€¢ Cá»™t 3: Ná»™i dung cÃ¢u há»i" styleClass="info-text"/>
                                <Label text="â€¢ Cá»™t 4-7: ÄÃ¡p Ã¡n A, B, C, D" styleClass="info-text"/>
                                <Label text="â€¢ Cá»™t 8: ÄÃ¡p Ã¡n Ä‘Ãºng (A/B/C/D)" styleClass="info-text"/>
                            </VBox>

                        </VBox>
                    </content>
                </ScrollPane>
            </Tab>


            <!-- Tab 3: Táº¡o báº±ng AI -->
            <Tab text="ðŸ¤– Táº¡o báº±ng AI" styleClass="main-tab">
                <ScrollPane fitToWidth="true" styleClass="scroll-pane">
                    <VBox spacing="25" styleClass="tab-content form-container" alignment="TOP_CENTER">
                        <padding><Insets top="40" right="60" bottom="40" left="60"/></padding>

                        <VBox spacing="10" alignment="CENTER">
                            <Label text="ðŸ¤– Táº¡o cÃ¢u há»i tá»± Ä‘á»™ng báº±ng AI" styleClass="section-title">
                                <font><Font name="System Bold" size="20"/></font>
                            </Label>
                            <Label text="Nháº­p mÃ´ táº£ vÃ  Ä‘á»ƒ AI tá»± Ä‘á»™ng táº¡o cÃ¢u há»i cho báº¡n"
                                   styleClass="subtitle"/>
                        </VBox>

                        <VBox spacing="15" maxWidth="800" styleClass="ai-form-container">
                            <VBox spacing="8">
                                <Label text="Chá»§ Ä‘á»/Ná»™i dung cÃ¢u há»i *" styleClass="form-label"/>
                                <TextArea fx:id="aiPromptArea"
                                          promptText="VÃ­ dá»¥: Táº¡o cÃ¢u há»i vá» Ä‘á»‹nh lÃ½ Pythagoras, phÆ°Æ¡ng trÃ¬nh báº­c 2, hoáº·c ngá»¯ phÃ¡p tiáº¿ng Anh..."
                                          prefRowCount="5" wrapText="true" styleClass="text-area"/>
                            </VBox>

                            <HBox spacing="15">
                                <VBox spacing="8" HBox.hgrow="ALWAYS">
                                    <Label text="MÃ´n há»c *" styleClass="form-label"/>
                                    <ComboBox fx:id="aiSubjectCombo" styleClass="form-combo" maxWidth="Infinity"/>
                                </VBox>

                                <VBox spacing="8" HBox.hgrow="ALWAYS">
                                    <Label text="Äá»™ khÃ³ *" styleClass="form-label"/>
                                    <ComboBox fx:id="aiDifficultyCombo" styleClass="form-combo" maxWidth="Infinity"/>
                                </VBox>

                                <VBox spacing="8">
                                    <Label text="Sá»‘ cÃ¢u há»i *" styleClass="form-label"/>
                                    <TextField fx:id="aiQuantityField" text="5"
                                               styleClass="text-field" prefWidth="100"/>
                                </VBox>
                            </HBox>

                            <VBox spacing="10" alignment="CENTER" styleClass="ai-info-box">
                                <Label text="ðŸ’¡ Máº¹o:" styleClass="info-title"/>
                                <Label text="CÃ ng mÃ´ táº£ chi tiáº¿t, AI sáº½ táº¡o cÃ¢u há»i cÃ ng chÃ­nh xÃ¡c"
                                       styleClass="info-text"/>
                            </VBox>

                            <HBox spacing="10" alignment="CENTER">
                                <padding><Insets top="10"/></padding>
                                <Button text="âœ¨ Táº¡o cÃ¢u há»i vá»›i AI" onAction="#handleGenerateWithAI"
                                        styleClass="ai-button" prefWidth="250"/>
                            </HBox>
                        </VBox>
                    </VBox>
                </ScrollPane>
            </Tab>

        </TabPane>
    </center>

</BorderPane>