<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Hyperlink?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane prefHeight="800.0" prefWidth="1400.0" style="-fx-background-color: #1a1a1a;" xmlns="http://javafx.com/javafx/25" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.edugame.server.controller.QuestionManagerController">

    <!-- Top: Header + Statistics -->
    <top>
        <VBox spacing="20" styleClass="main-container">
            <padding><Insets bottom="10" left="20" right="20" top="20" /></padding>

            <!-- Header -->
            <HBox alignment="CENTER_LEFT" spacing="15" styleClass="header">
                <Button onAction="#handleBackToServer" styleClass="back-button" text="â† Quay láº¡i" />
                <Label styleClass="header-title" text="Quáº£n lÃ½ CÃ¢u há»i">
                    <font><Font name="System Bold" size="22" /></font>
                </Label>
            </HBox>

            <!-- Statistics Cards -->
            <HBox spacing="15" styleClass="stats-container">
                <VBox styleClass="stat-card stat-card-total" HBox.hgrow="ALWAYS">
                    <Label fx:id="totalQuestionsLabel" styleClass="stat-number" text="0" />
                    <Label styleClass="stat-label" text="Tá»•ng cÃ¢u há»i" />
                </VBox>

                <VBox styleClass="stat-card stat-card-math" HBox.hgrow="ALWAYS">
                    <Label fx:id="mathQuestionsLabel" styleClass="stat-number" text="0" />
                    <Label styleClass="stat-label" text="ToÃ¡n há»c" />
                </VBox>

                <VBox styleClass="stat-card stat-card-literature" HBox.hgrow="ALWAYS">
                    <Label fx:id="literatureQuestionsLabel" styleClass="stat-number" text="0" />
                    <Label styleClass="stat-label" text="Ngá»¯ vÄƒn" />
                </VBox>

                <VBox styleClass="stat-card stat-card-english" HBox.hgrow="ALWAYS">
                    <Label fx:id="englishQuestionsLabel" styleClass="stat-number" text="0" />
                    <Label styleClass="stat-label" text="Tiáº¿ng Anh" />
                </VBox>
            </HBox>

            <!-- Search and Filters -->
            <HBox alignment="CENTER_LEFT" spacing="15" styleClass="filter-container">
                <TextField fx:id="searchField" prefWidth="400" promptText="ðŸ” TÃ¬m kiáº¿m cÃ¢u há»i..." styleClass="search-field" />
                <Label styleClass="filter-label" text="MÃ´n há»c:" />
                <ComboBox fx:id="subjectFilter" prefWidth="150" styleClass="filter-combo" />
                <Label styleClass="filter-label" text="Äá»™ khÃ³:" />
                <ComboBox fx:id="difficultyFilter" prefWidth="150" styleClass="filter-combo" />
            </HBox>
        </VBox>
    </top>

    <!-- Center: Tab Pane -->
    <center>
        <TabPane styleClass="main-tab-pane" tabClosingPolicy="UNAVAILABLE">
            <padding><Insets bottom="20" left="20" right="20" top="0" /></padding>

            <!-- Tab 1: Quáº£n lÃ½ cÃ¢u há»i -->
            <Tab styleClass="main-tab" text="ðŸ“‹ Quáº£n lÃ½ cÃ¢u há»i">
                <SplitPane dividerPositions="0.6" styleClass="split-pane">

                    <!-- Left: Question Table -->
                    <VBox spacing="10" styleClass="table-container">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label styleClass="section-title" text="Danh sÃ¡ch cÃ¢u há»i">
                                <font><Font name="System Bold" size="16" /></font>
                            </Label>
                            <Label fx:id="selectedCountLabel" styleClass="selected-label" text="" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Button onAction="#handleDeselectQuestion" styleClass="deselect-button" text="âŒ Bá» chá»n" />
                            <Button onAction="#handleDeleteQuestion" styleClass="delete-button" text="ðŸ—‘ï¸ XÃ³a" />
                        </HBox>

                        <TableView fx:id="questionTable" styleClass="question-table" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="sttColumn" prefWidth="50" text="STT" />
                                <TableColumn fx:id="subjectColumn" prefWidth="100" text="MÃ´n há»c" />
                                <TableColumn fx:id="contentColumn" prefWidth="200" text="Ná»™i dung" />
                                <TableColumn fx:id="answerAColumn" prefWidth="90" text="A" />
                                <TableColumn fx:id="answerBColumn" prefWidth="90" text="B" />
                                <TableColumn fx:id="answerCColumn" prefWidth="90" text="C" />
                                <TableColumn fx:id="answerDColumn" prefWidth="90" text="D" />
                                <TableColumn fx:id="correctAnswerColumn" prefWidth="60" text="ÄÃºng" />
                                <TableColumn fx:id="difficultyColumn" prefWidth="80" text="Äá»™ khÃ³" />
                            </columns>
                        </TableView>
                    </VBox>

                    <!-- Right: Question Form -->
                    <ScrollPane fitToWidth="true" styleClass="scroll-pane">
                        <VBox spacing="15" styleClass="form-container">
                            <padding><Insets bottom="15" left="15" right="15" top="10" /></padding>

                            <HBox alignment="CENTER_LEFT" spacing="10">
                                <Label styleClass="section-title" text="ThÃ´ng tin cÃ¢u há»i">
                                    <font><Font name="System Bold" size="16" /></font>
                                </Label>
                                <Region HBox.hgrow="ALWAYS" />
                                <Button onAction="#handleNewQuestion" styleClass="new-button" text="âž• Má»›i" />
                            </HBox>

                            <Separator />

                            <!-- Question Content -->
                            <VBox spacing="5">
                                <Label styleClass="form-label" text="Ná»™i dung cÃ¢u há»i *" />
                                <TextArea fx:id="questionContentArea" prefRowCount="3" promptText="Nháº­p ná»™i dung cÃ¢u há»i..." styleClass="text-area" wrapText="true" />
                            </VBox>

                            <!-- Subject and Difficulty -->
                            <HBox spacing="15">
                                <VBox spacing="5" HBox.hgrow="ALWAYS">
                                    <Label styleClass="form-label" text="MÃ´n há»c *" />
                                    <ComboBox fx:id="subjectCombo" maxWidth="Infinity" promptText="Chá»n mÃ´n há»c" styleClass="form-combo" />
                                </VBox>

                                <VBox spacing="5" HBox.hgrow="ALWAYS">
                                    <Label styleClass="form-label" text="Äá»™ khÃ³ *" />
                                    <ComboBox fx:id="difficultyCombo" maxWidth="Infinity" promptText="Chá»n Ä‘á»™ khÃ³" styleClass="form-combo" />
                                </VBox>
                            </HBox>

                            <Separator />

                            <!-- Answers -->
                            <VBox spacing="10">
                                <Label styleClass="form-label" text="CÃ¡c Ä‘Ã¡p Ã¡n">
                                    <font><Font name="System Bold" size="13" /></font>
                                </Label>

                                <VBox spacing="5">
                                    <Label styleClass="form-label-small" text="ÄÃ¡p Ã¡n A *" />
                                    <TextField fx:id="answerAField" promptText="Nháº­p Ä‘Ã¡p Ã¡n A" styleClass="text-field" />
                                </VBox>

                                <VBox spacing="5">
                                    <Label styleClass="form-label-small" text="ÄÃ¡p Ã¡n B *" />
                                    <TextField fx:id="answerBField" promptText="Nháº­p Ä‘Ã¡p Ã¡n B" styleClass="text-field" />
                                </VBox>

                                <VBox spacing="5">
                                    <Label styleClass="form-label-small" text="ÄÃ¡p Ã¡n C *" />
                                    <TextField fx:id="answerCField" promptText="Nháº­p Ä‘Ã¡p Ã¡n C" styleClass="text-field" />
                                </VBox>

                                <VBox spacing="5">
                                    <Label styleClass="form-label-small" text="ÄÃ¡p Ã¡n D *" />
                                    <TextField fx:id="answerDField" promptText="Nháº­p Ä‘Ã¡p Ã¡n D" styleClass="text-field" />
                                </VBox>
                            </VBox>

                            <Separator />

                            <!-- Correct Answer -->
                            <VBox spacing="5">
                                <Label styleClass="form-label" text="ÄÃ¡p Ã¡n Ä‘Ãºng *" />
                                <ComboBox fx:id="correctAnswerCombo" prefWidth="150" promptText="Chá»n Ä‘Ã¡p Ã¡n Ä‘Ãºng" styleClass="form-combo" />
                            </VBox>

                            <!-- Action Buttons -->
                            <HBox alignment="CENTER" spacing="10" styleClass="button-container">
                                <padding><Insets top="10" /></padding>
                                <Button fx:id="saveButton" onAction="#handleSaveQuestion" prefWidth="150" styleClass="save-button" text="ThÃªm cÃ¢u há»i" />
                                <Button onAction="#handleClearForm" prefWidth="100" styleClass="clear-button" text="LÃ m má»›i" />
                            </HBox>
                        </VBox>
                    </ScrollPane>

                </SplitPane>
            </Tab>

            <!-- Tab 2: Import tá»« file -->
            <Tab styleClass="main-tab" text="ðŸ“ Import tá»« file">
                <ScrollPane fitToWidth="true" pannable="true" styleClass="scroll-pane">
                    <content>
                        <VBox alignment="TOP_CENTER" spacing="20" styleClass="tab-content">
                            <padding><Insets bottom="40" left="40" right="40" top="40" /></padding>

                            <Label styleClass="section-title" text="ðŸ“„ Import cÃ¢u há»i tá»« file Excel/Word">
                                <font><Font name="System Bold" size="18" /></font>
                            </Label>

                            <VBox alignment="CENTER" maxWidth="600" spacing="20" styleClass="upload-area">
                                <VBox alignment="CENTER" spacing="15">
                                    <Label styleClass="upload-icon" text="ðŸ“‚" />
                                    <Label styleClass="upload-text" text="KÃ©o tháº£ file vÃ o Ä‘Ã¢y hoáº·c click Ä‘á»ƒ chá»n file" />
                                    <Label styleClass="upload-hint" text="Há»— trá»£: Excel (.xlsx, .xls) vÃ  Word (.docx, .doc)" />
                                </VBox>

                                <Button onAction="#handleImportFile" styleClass="upload-button" text="â¬† Chá»n file Ä‘á»ƒ upload" />
                            </VBox>

                            <VBox alignment="CENTER_LEFT" spacing="10" styleClass="info-box">
                                <Label styleClass="info-title" text="ðŸ“ HÆ°á»›ng dáº«n Ä‘á»‹nh dáº¡ng file:" />
                                <Label styleClass="info-text" text="â€¢ Cá»™t 1: MÃ´n há»c (ToÃ¡n há»c/Ngá»¯ vÄƒn/Tiáº¿ng Anh)" />
                                <Label styleClass="info-text" text="â€¢ Cá»™t 2: Äá»™ khÃ³ (Dá»…/Trung bÃ¬nh/KhÃ³)" />
                                <Label styleClass="info-text" text="â€¢ Cá»™t 3: Ná»™i dung cÃ¢u há»i" />
                                <Label styleClass="info-text" text="â€¢ Cá»™t 4-7: ÄÃ¡p Ã¡n A, B, C, D" />
                                <Label styleClass="info-text" text="â€¢ Cá»™t 8: ÄÃ¡p Ã¡n Ä‘Ãºng (A/B/C/D)" />
                            </VBox>
                     <Hyperlink fx:id="DownloadSample" onAction="#handleDownloadSample" text="Táº£i máº«u Ä‘á»‹nh dáº¡ng" />

                        </VBox>
                    </content>
                </ScrollPane>
            </Tab>


            <!-- Tab 3: Táº¡o báº±ng AI -->
            <Tab styleClass="main-tab" text="ðŸ¤– Táº¡o báº±ng AI">
                <ScrollPane fitToWidth="true" styleClass="scroll-pane">
                    <VBox alignment="TOP_CENTER" spacing="25" styleClass="tab-content form-container">
                        <padding><Insets bottom="40" left="60" right="60" top="40" /></padding>

                        <VBox alignment="CENTER" spacing="10">
                            <Label styleClass="section-title" text="ðŸ¤– Táº¡o cÃ¢u há»i tá»± Ä‘á»™ng báº±ng AI">
                                <font><Font name="System Bold" size="20" /></font>
                            </Label>
                            <Label styleClass="subtitle" text="Nháº­p mÃ´ táº£ vÃ  Ä‘á»ƒ AI tá»± Ä‘á»™ng táº¡o cÃ¢u há»i cho báº¡n" />
                        </VBox>

                        <VBox maxWidth="800" spacing="15" styleClass="ai-form-container">
                            <VBox spacing="8">
                                <Label styleClass="form-label" text="Chá»§ Ä‘á»/Ná»™i dung cÃ¢u há»i *" />
                                <TextArea fx:id="aiPromptArea" prefRowCount="5" promptText="VÃ­ dá»¥: Táº¡o cÃ¢u há»i vá» Ä‘á»‹nh lÃ½ Pythagoras, phÆ°Æ¡ng trÃ¬nh báº­c 2, hoáº·c ngá»¯ phÃ¡p tiáº¿ng Anh..." styleClass="text-area" wrapText="true" />
                            </VBox>

                            <HBox spacing="15">
                                <VBox spacing="8" HBox.hgrow="ALWAYS">
                                    <Label styleClass="form-label" text="MÃ´n há»c *" />
                                    <ComboBox fx:id="aiSubjectCombo" maxWidth="Infinity" styleClass="form-combo" />
                                </VBox>

                                <VBox spacing="8" HBox.hgrow="ALWAYS">
                                    <Label styleClass="form-label" text="Äá»™ khÃ³ *" />
                                    <ComboBox fx:id="aiDifficultyCombo" maxWidth="Infinity" styleClass="form-combo" />
                                </VBox>

                                <VBox spacing="8">
                                    <Label styleClass="form-label" text="Sá»‘ cÃ¢u há»i *" />
                                    <TextField fx:id="aiQuantityField" prefWidth="100" styleClass="text-field" text="5" />
                                </VBox>
                            </HBox>

                            <VBox alignment="CENTER" spacing="10" styleClass="ai-info-box">
                                <Label styleClass="info-title" text="ðŸ’¡ Máº¹o:" />
                                <Label styleClass="info-text" text="CÃ ng mÃ´ táº£ chi tiáº¿t, AI sáº½ táº¡o cÃ¢u há»i cÃ ng chÃ­nh xÃ¡c" />
                            </VBox>

                            <HBox alignment="CENTER" spacing="10">
                                <padding><Insets top="10" /></padding>
                                <Button onAction="#handleGenerateWithAI" prefWidth="250" styleClass="ai-button" text="âœ¨ Táº¡o cÃ¢u há»i vá»›i AI" />
                            </HBox>
                        </VBox>
                    </VBox>
                </ScrollPane>
            </Tab>

        </TabPane>
    </center>

</BorderPane>
