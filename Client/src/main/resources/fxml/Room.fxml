<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.Tooltip?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.shape.Circle?>

<AnchorPane prefHeight="700.0" prefWidth="1200.0" styleClass="root" stylesheets="@../css/room.css, @../css/common.css" xmlns="http://javafx.com/javafx/25" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.edugame.client.controller.RoomController">

    <!-- ============================================ -->
    <!-- HEADER: Back Button & Room ID -->
    <!-- ============================================ -->
    <HBox alignment="CENTER_LEFT" spacing="20" AnchorPane.leftAnchor="20" AnchorPane.rightAnchor="20" AnchorPane.topAnchor="15">

        <!-- Back Button -->
        <Button fx:id="btnBack" styleClass="back-button">
            <graphic>
                <HBox alignment="CENTER" spacing="8">
                    <Label style="-fx-font-size: 20; -fx-text-fill: white;" text="âŸµ" />
                    <Label style="-fx-font-size: 14; -fx-text-fill: white; -fx-font-weight: bold;" text="Trá»Ÿ vá»" />
                </HBox>
            </graphic>
        </Button>

        <Region HBox.hgrow="ALWAYS" />

        <!-- Room ID Display -->
        <HBox alignment="CENTER" spacing="10" styleClass="room-id-container">
            <Label style="-fx-font-size: 18;" text="ðŸ " />
            <VBox spacing="2">
                <Label style="-fx-text-fill: #aaaaaa; -fx-font-size: 11;" text="ID PhÃ²ng" />
                <Label fx:id="lblRoomId" styleClass="room-id-text" text="579494" />
            </VBox>
        </HBox>
    </HBox>

    <!-- ============================================ -->
    <!-- CENTER: 4 Player Slots (CENTERED) -->
    <!-- ============================================ -->
    <GridPane alignment="CENTER" hgap="35" vgap="35" AnchorPane.leftAnchor="150" AnchorPane.rightAnchor="330" AnchorPane.topAnchor="120">

        <columnConstraints>
            <ColumnConstraints halignment="CENTER" prefWidth="180" />
            <ColumnConstraints halignment="CENTER" prefWidth="180" />
            <ColumnConstraints halignment="CENTER" prefWidth="180" />
            <ColumnConstraints halignment="CENTER" prefWidth="180" />
        </columnConstraints>

        <rowConstraints>
            <RowConstraints prefHeight="230" valignment="CENTER" />
        </rowConstraints>

        <!-- Player Slot 1 (Host) -->
        <VBox alignment="CENTER" spacing="8" styleClass="player-slot-host" GridPane.columnIndex="0">
            <StackPane>
                <Circle radius="50" styleClass="avatar-border-host" />
                <ImageView fx:id="avatar1" fitHeight="90" fitWidth="90" preserveRatio="true">
                    <clip>
                        <Circle centerX="45" centerY="45" radius="45" />
                    </clip>
                </ImageView>

                <!-- Crown Icon for Host -->
                <Label style="-fx-font-size: 18;" text="ðŸ‘‘" translateY="-8" StackPane.alignment="TOP_CENTER" />
                <!-- Ready Status -->
                <Circle fx:id="readyIndicator1" fill="#4caf50" radius="8" translateX="10" translateY="8" visible="false" StackPane.alignment="BOTTOM_RIGHT" />
            </StackPane>

            <VBox alignment="CENTER" spacing="2">
                <Label fx:id="name1" styleClass="player-name-host" text="NgÆ°á»i chÆ¡i 1" />
                <Label fx:id="score1" styleClass="player-score" text="â­ 1250" />
                <Label styleClass="host-badge" text="Chá»§ phÃ²ng" />
            </VBox>
        </VBox>

        <!-- Player Slot 2 -->
        <VBox alignment="CENTER" spacing="8" styleClass="player-slot-empty" GridPane.columnIndex="1">
            <StackPane>
                <Circle radius="50" styleClass="avatar-border-empty" />
                <ImageView fx:id="avatar2" fitHeight="90" fitWidth="90" preserveRatio="true">
                    <clip>
                        <Circle centerX="45" centerY="45" radius="45" />
                    </clip>
                </ImageView>

                <!-- Kick icon (áº©n máº·c Ä‘á»‹nh, chá»‰ hiá»‡n vá»›i host) -->
                <Label fx:id="kickIcon2" style="-fx-font-size: 16; -fx-text-fill: #ff5555; -fx-cursor: hand;" text="âŒ" translateX="-6" translateY="6" visible="false" StackPane.alignment="TOP_RIGHT" />

                <Label fx:id="emptyIcon2" style="-fx-font-size: 38; -fx-text-fill: #555555;" text="+" />
                <Circle fx:id="readyIndicator2" fill="#4caf50" radius="8" translateX="10" translateY="8" visible="false" StackPane.alignment="BOTTOM_RIGHT" />
            </StackPane>

            <VBox alignment="CENTER" spacing="2">
                <Label fx:id="name2" styleClass="player-name-empty" text="Äang chá»..." />
                <Label fx:id="score2" styleClass="player-score" text="" />
            </VBox>
        </VBox>


        <!-- Player Slot 3 -->
        <VBox alignment="CENTER" spacing="8" styleClass="player-slot-empty" GridPane.columnIndex="2">
            <StackPane>
                <Circle radius="50" styleClass="avatar-border-empty" />
                <ImageView fx:id="avatar3" fitHeight="90" fitWidth="90" preserveRatio="true">
                    <clip>
                        <Circle centerX="45" centerY="45" radius="45" />
                    </clip>
                </ImageView>

                <!-- Kick icon -->
                <Label fx:id="kickIcon3" style="-fx-font-size: 16; -fx-text-fill: #ff5555; -fx-cursor: hand;" text="âŒ" translateX="-6" translateY="6" visible="false" StackPane.alignment="TOP_RIGHT" />

                <Label fx:id="emptyIcon3" style="-fx-font-size: 38; -fx-text-fill: #555555;" text="+" />
                <Circle fx:id="readyIndicator3" fill="#4caf50" radius="8" translateX="10" translateY="8" visible="false" StackPane.alignment="BOTTOM_RIGHT" />
            </StackPane>

            <VBox alignment="CENTER" spacing="2">
                <Label fx:id="name3" styleClass="player-name-empty" text="Äang chá»..." />
                <Label fx:id="score3" styleClass="player-score" text="" />
            </VBox>
        </VBox>


        <!-- Player Slot 4 -->
        <VBox alignment="CENTER" spacing="8" styleClass="player-slot-empty" GridPane.columnIndex="3">
            <StackPane>
                <Circle radius="50" styleClass="avatar-border-empty" />
                <ImageView fx:id="avatar4" fitHeight="90" fitWidth="90" preserveRatio="true">
                    <clip>
                        <Circle centerX="45" centerY="45" radius="45" />
                    </clip>
                </ImageView>

                <!-- Kick icon -->
                <Label fx:id="kickIcon4" style="-fx-font-size: 16; -fx-text-fill: #ff5555; -fx-cursor: hand;" text="âŒ" translateX="-6" translateY="6" visible="false" StackPane.alignment="TOP_RIGHT" />

                <Label fx:id="emptyIcon4" style="-fx-font-size: 38; -fx-text-fill: #555555;" text="+" />
                <Circle fx:id="readyIndicator4" fill="#4caf50" radius="8" translateX="10" translateY="8" visible="false" StackPane.alignment="BOTTOM_RIGHT" />
            </StackPane>

            <VBox alignment="CENTER" spacing="2">
                <Label fx:id="name4" styleClass="player-name-empty" text="Äang chá»..." />
                <Label fx:id="score4" styleClass="player-score" text="" />
            </VBox>
        </VBox>


    </GridPane>

    <!-- ============================================ -->
    <!-- BOTTOM LEFT: Room Chat -->
    <!-- ============================================ -->
    <VBox prefHeight="280" prefWidth="400.0" spacing="8" styleClass="chat-container" AnchorPane.bottomAnchor="20" AnchorPane.leftAnchor="20">

        <padding>
            <Insets topRightBottomLeft="12" />
        </padding>

        <!-- Chat Header -->
        <HBox alignment="CENTER_LEFT" spacing="8">
            <Label style="-fx-font-size: 18;" text="ðŸ’¬" />
            <Label styleClass="chat-header" text="Chat PhÃ²ng" />
            <Region HBox.hgrow="ALWAYS" />
            <Label fx:id="onlineCount" style="-fx-text-fill: #4caf50; -fx-font-size: 12; -fx-font-weight: bold;" text="ðŸŸ¢ 1/4" />
        </HBox>

        <Separator style="-fx-background-color: #3a3a3a;" />

        <!-- Chat Messages with ScrollPane -->
        <ScrollPane fx:id="chatScrollPane" fitToWidth="true" hbarPolicy="NEVER" prefHeight="210" styleClass="chat-list" vbarPolicy="AS_NEEDED" VBox.vgrow="ALWAYS">
            <content>
                <VBox fx:id="chatMessagesContainer" spacing="8">
                    <padding>
                        <Insets topRightBottomLeft="8" />
                    </padding>
                </VBox>
            </content>
        </ScrollPane>

        <!-- Chat Input -->
        <HBox alignment="CENTER_LEFT" spacing="8">
            <Button fx:id="emojiButton" style="-fx-background-color: transparent; -fx-font-size: 16px; -fx-cursor: hand;" text="ðŸ˜Š" />

            <!-- Voice Chat Button -->
            <Button fx:id="btnVoiceChat" styleClass="voice-button">
                <graphic>
                    <Label fx:id="micIcon" style="-fx-font-size: 16px;" text="ðŸŽ¤" />
                </graphic>
                <tooltip>
                    <Tooltip text="Voice Chat (Nháº¥n Ä‘á»ƒ báº­t/táº¯t)" />
                </tooltip>
            </Button>

            <TextField fx:id="chatInputField" promptText="Nháº­p tin nháº¯n..." styleClass="chat-input" HBox.hgrow="ALWAYS" />
            <Button fx:id="btnSendChat" styleClass="send-button" text="Gá»­i" />
        </HBox>
    </VBox>


    <!-- ============================================ -->
    <!-- RIGHT PANEL: Friends List & Actions -->
    <!-- ============================================ -->
    <!-- ============================================ -->
    <!-- RIGHT PANEL: Friends List & Actions -->
    <!-- ============================================ -->
    <VBox prefWidth="280" spacing="12" styleClass="friends-panel" AnchorPane.bottomAnchor="20" AnchorPane.rightAnchor="20" AnchorPane.topAnchor="80">

        <!-- Friends List Header -->
        <HBox alignment="CENTER_LEFT" spacing="8">
            <Label style="-fx-font-size: 18;" text="ðŸ‘¥" />
            <Label styleClass="friends-header" text="Danh sÃ¡ch báº¡n bÃ¨" />
        </HBox>

        <Separator style="-fx-background-color: #3a3a3a;" />

        <!-- Status Filter Buttons -->
        <HBox alignment="CENTER" spacing="8">
            <Button fx:id="btnFilterAll" styleClass="filter-button, filter-active" text="Táº¥t cáº£" />
            <Button fx:id="btnFilterOnline" styleClass="filter-button" text="ðŸŸ¢ Online" />
            <Button fx:id="btnFilterInGame" styleClass="filter-button" text="ðŸŽ® Trong tráº­n" />
        </HBox>

        <!-- Friends Card List -->
        <ScrollPane fx:id="friendsScrollPane" fitToWidth="true" hbarPolicy="NEVER" styleClass="friend-scroll-pane" vbarPolicy="AS_NEEDED" VBox.vgrow="ALWAYS">
            <content>
                <VBox fx:id="friendCardsContainer" spacing="10" styleClass="friend-cards-container">
                    <!-- Sample Friend Card -->
                    <HBox alignment="CENTER_LEFT" spacing="10" styleClass="friend-card">
                        <ImageView fx:id="avatarSample" fitHeight="50" fitWidth="50" preserveRatio="true">
                            <clip>
                                <Circle centerX="25" centerY="25" radius="25" />
                            </clip>
                        </ImageView>

                        <VBox alignment="CENTER_LEFT" spacing="3" HBox.hgrow="ALWAYS">
                            <Label styleClass="friend-name" text="Nguyá»…n VÄƒn A" />
                            <Label styleClass="friend-score" text="â­ 1250 Ä‘iá»ƒm" />
                        </VBox>

                        <Button fx:id="btnInviteFriendSample" styleClass="invite-icon-button" text="âž•">
                            <tooltip>
                                <Tooltip text="Má»i vÃ o phÃ²ng" />
                            </tooltip>
                        </Button>

                    </HBox>

                    <!-- CÃ³ thá»ƒ thÃªm Ä‘á»™ng cÃ¡c friend-card khÃ¡c trong Controller -->
                </VBox>
            </content>
        </ScrollPane>

        <!-- Ready/Start Button -->
        <StackPane>
            <!-- Ready Button (for players) -->
            <Button fx:id="btnReady" styleClass="action-button, ready-button" text="âœ“ Sáºµn sÃ ng" />

            <!-- Start Button (for host, only visible when all ready) -->
            <Button fx:id="btnStart" managed="false" styleClass="action-button, start-button" text="â–¶ Báº¯t Ä‘áº§u trÃ² chÆ¡i" visible="false" />
        </StackPane>
    </VBox>


</AnchorPane>
